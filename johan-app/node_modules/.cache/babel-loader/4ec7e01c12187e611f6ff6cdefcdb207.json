{"ast":null,"code":"import _regeneratorRuntime from\"/Applications/MAMP/htdocs/WEB/johandemeij/johan-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Applications/MAMP/htdocs/WEB/johandemeij/johan-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Applications/MAMP/htdocs/WEB/johandemeij/johan-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import{connect}from\"react-redux\";import{bindActionCreators}from\"redux\";import{Form,Container,Row,Col,Button}from\"react-bootstrap\";import{ACTIONS}from\"redux/actions/types\";import SideNav from\"components/dashboard/SideNav\";import{mainAction}from\"redux/actions/index.actions\";import CKEditor from'@ckeditor/ckeditor5-react';import ClassicEditor from'@ckeditor/ckeditor5-build-classic';import _ from\"lodash\";import CdImage from\"components/dashboard/CdImage\";import AdditionalInfo from\"components/dashboard/AdditionalInfo\";import dayjs from\"dayjs\";var NewCd=function NewCd(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),validated=_useState2[0],setValidated=_useState2[1];var _useState3=useState(props.cd.cd_name?props.cd.cd_name:\"\"),_useState4=_slicedToArray(_useState3,2),field_cd_name=_useState4[0],setcd_name=_useState4[1];var _useState5=useState(props.cd.synopsis?props.cd.synopsis:\"\"),_useState6=_slicedToArray(_useState5,2),field_synopsis=_useState6[0],setSynopsis=_useState6[1];var _useState7=useState(props.cd.totalTime?props.cd.totalTime:\"\"),_useState8=_slicedToArray(_useState7,2),field_totalTime=_useState8[0],setTotalTime=_useState8[1];var _useState9=useState(props.cd.category?props.cd.category:\"\"),_useState10=_slicedToArray(_useState9,2),field_category=_useState10[0],setCategory=_useState10[1];var _useState11=useState(props.cd.add_info?props.cd.add_info:\"\"),_useState12=_slicedToArray(_useState11,2),field_addInfo=_useState12[0],setAddInfo=_useState12[1];var d=new Date();var _useState13=useState(dayjs(d).format('YYYYMMDDHHmmss')),_useState14=_slicedToArray(_useState13,2),id=_useState14[0],setId=_useState14[1];var cdId=props.match.params.id?props.match.params.id:\"\";useEffect(function(){// Update the document title using the browser API\nwindow.scrollTo(0,0);props.actions.mainAction(ACTIONS.LOAD_ALL_PRESENTATIONS,[]);if(cdId)props.actions.mainAction(ACTIONS.LOAD_CD,cdId);props.actions.mainAction(ACTIONS.LOAD_CDS,[]);// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);var handleSubmit=function handleSubmit(event){event.preventDefault();var testArray=[];var cdItem={id:id,cd_name:field_cd_name,synopsis:field_synopsis,category:field_category,add_info:field_addInfo,totalTime:field_totalTime};var form=event.currentTarget;if(form.checkValidity()===false){event.stopPropagation();}setValidated(true);props.actions.mainAction(ACTIONS.CREATE_NEW_CD,cdItem);props.history.push('/dashboard/cds/edit/'+id);console.log(cdItem);};var handleUpdate=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var cdItem,form;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();cdItem={_id:props.cd._id,cd_name:document.getElementById('cd_name').value,synopsis:field_synopsis,totalTime:document.getElementById('totalTime').value,category:document.getElementById('category').value};form=event.currentTarget;if(form.checkValidity()===false){event.stopPropagation();}setValidated(true);props.actions.mainAction(ACTIONS.UPDATE_CD,cdItem);setTimeout(function(){window.location.reload();},1);case 7:case\"end\":return _context.stop();}}},_callee);}));return function handleUpdate(_x){return _ref.apply(this,arguments);};}();var renderCdImage=function renderCdImage(){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(CdImage,{docId:props.cd._id,ID:props.cd.id,image:props.cd.cdImage,caption:\"\",type:\"main\"}),/*#__PURE__*/React.createElement(CdImage,{docId:props.cd._id,ID:props.cd.id,image:props.cd.frontCover,caption:props.cd.frontCaption,type:\"front\"}),/*#__PURE__*/React.createElement(CdImage,{docId:props.cd._id,ID:props.cd.id,image:props.cd.backCover,caption:props.cd.backCaption,type:\"back\"}));};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Container,{className:\"dashboard\"},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{lg:{span:2}},/*#__PURE__*/React.createElement(SideNav,null)),/*#__PURE__*/React.createElement(Col,{lg:{span:\"10\"}},Object.keys(props.cd).length>0?renderCdImage():'',/*#__PURE__*/React.createElement(\"section\",{id:\"product\"},/*#__PURE__*/React.createElement(Form,{noValidate:true,validated:validated,onSubmit:Object.keys(props.cd).length>0?handleUpdate:handleSubmit},/*#__PURE__*/React.createElement(Form.Row,null,/*#__PURE__*/React.createElement(Col,{lg:\"12\"},/*#__PURE__*/React.createElement(Form.Group,{as:Col,controlId:\"cd_name\"},/*#__PURE__*/React.createElement(Form.Label,null,\"Name\"),/*#__PURE__*/React.createElement(Form.Control,{required:true,type:\"text\",placeholder:\"\",defaultValue:props.cd.cd_name,onChange:function onChange(e){return setcd_name(e.target.value);},onBlur:function onBlur(e){return setcd_name(e.target.value);}}),/*#__PURE__*/React.createElement(Form.Control.Feedback,{type:\"invalid\"},\"Please provide a name.\"),/*#__PURE__*/React.createElement(Form.Control.Feedback,null,\"Looks good!\")))),/*#__PURE__*/React.createElement(Form.Row,null,/*#__PURE__*/React.createElement(Col,{lg:\"6\"},/*#__PURE__*/React.createElement(Form.Group,{as:Col,controlId:\"category\"},/*#__PURE__*/React.createElement(Form.Label,null,\"Category\"),/*#__PURE__*/React.createElement(Form.Control,{required:true,as:\"select\",onChange:function onChange(e){return setCategory(e.target.value);},onBlur:function onBlur(e){return setCategory(e.target.value);},defaultValue:props.cd.category},props.cd.category>0?/*#__PURE__*/React.createElement(\"option\",{value:props.cd.category,selected:true},props.categories.filter(function(category){return category.id===parseInt(props.cd.category,10);}).map(function(category){return category.name;})):\"\",props.categories.map(function(category){return/*#__PURE__*/React.createElement(\"option\",{value:category.id},category.name);})),/*#__PURE__*/React.createElement(Form.Control.Feedback,{type:\"invalid\"},\"Please provide a video.\"),/*#__PURE__*/React.createElement(Form.Control.Feedback,null,\"Looks good!\"))),/*#__PURE__*/React.createElement(Col,{lg:\"6\"},/*#__PURE__*/React.createElement(Form.Group,{as:Col,controlId:\"totalTime\"},/*#__PURE__*/React.createElement(Form.Label,null,\"Total Time\"),/*#__PURE__*/React.createElement(Form.Control,{required:true,type:\"text\",placeholder:\"\",defaultValue:props.cd.totalTime,onChange:function onChange(e){return setTotalTime(e.target.value);},onBlur:function onBlur(e){return setTotalTime(e.target.value);}}),/*#__PURE__*/React.createElement(Form.Control.Feedback,{type:\"invalid\"},\"Please provide a video.\"),/*#__PURE__*/React.createElement(Form.Control.Feedback,null,\"Looks good!\")))),/*#__PURE__*/React.createElement(Form.Row,null,/*#__PURE__*/React.createElement(Col,{lg:\"12\"},/*#__PURE__*/React.createElement(AdditionalInfo,{cdId:cdId,match:props.match}))),/*#__PURE__*/React.createElement(Form.Row,null,/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Form.Group,{as:Col,controlId:\"add-info\"},/*#__PURE__*/React.createElement(CKEditor,{editor:ClassicEditor,data:props.cd.synopsis?props.cd.synopsis:field_synopsis,toolbar:('heading','|','bold','italic','link','bulletedList','numberedList','blockQuote'),onInit:function onInit(editor){// You can store the \"editor\" and use when it is needed.\n// console.log( 'Editor is ready to use!', editor );\n},onChange:function onChange(event,editor){var data=editor.getData();// console.log( { event, editor, data } );\nsetSynopsis(data);},onBlur:function onBlur(event,editor){var data=editor.getData();console.log('Blur.',editor);setSynopsis(data);},onFocus:function onFocus(event,editor){console.log('Focus.',editor);}})))),/*#__PURE__*/React.createElement(Button,{type:\"submit\"},Object.keys(props.cd).length>0?\"Update CD\":\"Create CD\")))))));};function mapStateToProps(state){return{allPresentations:state.AllPresentationsReducer,categories:state.musicReducer.categories,cd:state.cdReducer,allCds:state.cdsReducer,lastCdId:_.orderBy(state.cdsReducer,\"id\",\"desc\").map(function(cd,i){return i===0?cd:\"\";})};}function mapDispatchToProps(dispatch){return{actions:bindActionCreators({mainAction:mainAction},dispatch)};}export default connect(mapStateToProps,mapDispatchToProps)(NewCd);","map":{"version":3,"sources":["/Applications/MAMP/htdocs/WEB/johandemeij/johan-app/src/components/dashboard/NewCd.jsx"],"names":["React","useEffect","useState","connect","bindActionCreators","Form","Container","Row","Col","Button","ACTIONS","SideNav","mainAction","CKEditor","ClassicEditor","_","CdImage","AdditionalInfo","dayjs","NewCd","props","validated","setValidated","cd","cd_name","field_cd_name","setcd_name","synopsis","field_synopsis","setSynopsis","totalTime","field_totalTime","setTotalTime","category","field_category","setCategory","add_info","field_addInfo","setAddInfo","d","Date","format","id","setId","cdId","match","params","window","scrollTo","actions","LOAD_ALL_PRESENTATIONS","LOAD_CD","LOAD_CDS","handleSubmit","event","preventDefault","testArray","cdItem","form","currentTarget","checkValidity","stopPropagation","CREATE_NEW_CD","history","push","console","log","handleUpdate","_id","document","getElementById","value","UPDATE_CD","setTimeout","location","reload","renderCdImage","cdImage","frontCover","frontCaption","backCover","backCaption","span","Object","keys","length","e","target","categories","filter","parseInt","map","name","editor","data","getData","mapStateToProps","state","allPresentations","AllPresentationsReducer","musicReducer","cdReducer","allCds","cdsReducer","lastCdId","orderBy","i","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport { bindActionCreators } from \"redux\";\nimport { Form, Container, Row, Col, Button} from \"react-bootstrap\";\nimport { ACTIONS } from \"redux/actions/types\";\nimport SideNav from \"components/dashboard/SideNav\";\nimport { mainAction } from \"redux/actions/index.actions\"\nimport CKEditor from '@ckeditor/ckeditor5-react';\nimport ClassicEditor from '@ckeditor/ckeditor5-build-classic';\nimport _ from \"lodash\"\nimport CdImage from \"components/dashboard/CdImage\"\nimport AdditionalInfo from \"components/dashboard/AdditionalInfo\"\nimport dayjs from \"dayjs\"\nconst NewCd = props => {\n  const [validated, setValidated] = useState(false);\n  const [field_cd_name,setcd_name] = useState(props.cd.cd_name ? props.cd.cd_name:\"\")\n  const [field_synopsis,setSynopsis] = useState(props.cd.synopsis ? props.cd.synopsis:\"\")\n  const [field_totalTime,setTotalTime] = useState(props.cd.totalTime ? props.cd.totalTime:\"\")\n  const [field_category,setCategory] = useState(props.cd.category ? props.cd.category:\"\")\n  const [field_addInfo,setAddInfo] = useState(props.cd.add_info ? props.cd.add_info:\"\")\n  let d = new Date()\n  const [id, setId] = useState(dayjs(d).format('YYYYMMDDHHmmss'));\n let cdId = props.match.params.id  ? props.match.params.id : \"\"\n\n  useEffect(() => {\n    // Update the document title using the browser API\n    window.scrollTo(0,0)\n    props.actions.mainAction(ACTIONS.LOAD_ALL_PRESENTATIONS,[])\n  \n    if(cdId)\n    props.actions.mainAction(ACTIONS.LOAD_CD,cdId)\n    props.actions.mainAction(ACTIONS.LOAD_CDS,[])\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  const handleSubmit = event => {\n    event.preventDefault();\n    let testArray = []\n   \n    let cdItem = {\n        id,\n        cd_name:field_cd_name,\n        synopsis:field_synopsis,\n        category:field_category,\n        add_info:field_addInfo,\n        totalTime:field_totalTime\n    }\n\n    const form = event.currentTarget;\n    if (form.checkValidity() === false) {\n      event.stopPropagation();\n    }\n    setValidated(true);\n   props.actions.mainAction(ACTIONS.CREATE_NEW_CD,cdItem)\n    props.history.push('/dashboard/cds/edit/'+id)\n   console.log(cdItem)\n  };\n  const handleUpdate = async event => {\n    event.preventDefault();\n    let cdItem = {\n        _id:props.cd._id,\n        cd_name:document.getElementById('cd_name').value,\n        synopsis:field_synopsis,\n        totalTime:document.getElementById('totalTime').value,\n        category:document.getElementById('category').value\n    }\n\n    const form = event.currentTarget;\n    if (form.checkValidity() === false) {\n      event.stopPropagation();\n    }\n    setValidated(true);\n    props.actions.mainAction(ACTIONS.UPDATE_CD,cdItem)\n    setTimeout(()=>{ \n      window.location.reload()\n     }, 1);\n  }\n  const renderCdImage = () => {\n      return (<>\n<CdImage docId={props.cd._id} ID={props.cd.id} image={props.cd.cdImage}  caption=\"\" type=\"main\" />\n<CdImage docId={props.cd._id} ID={props.cd.id} image={props.cd.frontCover} caption={props.cd.frontCaption} type=\"front\" />\n<CdImage docId={props.cd._id} ID={props.cd.id} image={props.cd.backCover} caption={props.cd.backCaption} type=\"back\" />\n      </>)\n  }\n\n  return (\n    <>\n      <Container className=\"dashboard\">\n        <Row>\n          \n          <Col lg={{ span: 2 }}>\n              <SideNav />\n          </Col>\n          <Col lg={{span:\"10\" }}> \n          \n          {Object.keys(props.cd).length > 0 ? renderCdImage():''}\n            <section id=\"product\">\n              <Form noValidate validated={validated} onSubmit={Object.keys(props.cd).length > 0 ?handleUpdate :handleSubmit}>\n              <Form.Row><Col lg=\"12\">\n                  <Form.Group as={Col}  controlId=\"cd_name\">\n                     <Form.Label>Name</Form.Label>\n                    <Form.Control\n                      required\n                      type=\"text\"\n                      placeholder=\"\"\n                      defaultValue={props.cd.cd_name}\n                      onChange={e => setcd_name(e.target.value)}\n                      onBlur={e => setcd_name(e.target.value)}\n                    />\n                    <Form.Control.Feedback type=\"invalid\">\n                        Please provide a name.\n                      </Form.Control.Feedback>\n                    <Form.Control.Feedback>Looks good!</Form.Control.Feedback>\n                  </Form.Group></Col>\n                  </Form.Row> \n                \n                <Form.Row>\n                    <Col lg=\"6\"><Form.Group as={Col} controlId=\"category\">\n                    <Form.Label>Category</Form.Label>\n                    <Form.Control\n                      required\n                      as=\"select\"\n                      onChange={e => setCategory(e.target.value)}\n                      onBlur={e => setCategory(e.target.value)}\n                      defaultValue={props.cd.category}\n                    >\n                    {props.cd.category > 0 ? <option value={props.cd.category} selected>{props.categories.filter(category => category.id === parseInt(props.cd.category,10)).map(category => category.name)}</option> : \"\"}\n                    {props.categories.map(category=>{\n                        return <option value={category.id}>{category.name}</option>\n                    })}\n                        \n                    </Form.Control>\n                    <Form.Control.Feedback type=\"invalid\">\n                        Please provide a video.\n                      </Form.Control.Feedback>\n                    <Form.Control.Feedback>Looks good!</Form.Control.Feedback>\n                  </Form.Group></Col>\n                    <Col lg=\"6\"><Form.Group as={Col} controlId=\"totalTime\">\n                    <Form.Label>Total Time</Form.Label>\n                     <Form.Control\n                      required\n                      type=\"text\"\n                      placeholder=\"\"\n                      defaultValue={props.cd.totalTime}\n                      onChange={e => setTotalTime(e.target.value)}\n                      onBlur={e => setTotalTime(e.target.value)}\n                    />\n                    <Form.Control.Feedback type=\"invalid\">\n                        Please provide a video.\n                      </Form.Control.Feedback>\n                    <Form.Control.Feedback>Looks good!</Form.Control.Feedback>\n                  </Form.Group></Col>\n                  \n                  \n                </Form.Row>\n                <Form.Row>\n                    \n                    <Col lg=\"12\">\n                  <AdditionalInfo cdId={cdId} match={props.match}/>\n                  </Col>\n                  \n                  \n                </Form.Row>\n                <Form.Row>\n                  <Col>\n                  <Form.Group as={Col} controlId=\"add-info\">\n                    <CKEditor\n                        editor={ ClassicEditor }\n                        data={props.cd.synopsis ? props.cd.synopsis: field_synopsis}\n                        toolbar= {'heading', '|', 'bold', 'italic', 'link', 'bulletedList', 'numberedList', 'blockQuote' }\n                        onInit={ editor => {\n                            // You can store the \"editor\" and use when it is needed.\n                           // console.log( 'Editor is ready to use!', editor );\n                        } }\n                        onChange={ ( event, editor ) => {\n                            const data = editor.getData();\n                           // console.log( { event, editor, data } );\n                           setSynopsis(data)\n                        } }\n                        onBlur={ ( event, editor ) => {\n                          const data = editor.getData();\n                            console.log( 'Blur.', editor );\n                            setSynopsis(data)\n                        } }\n                        onFocus={ ( event, editor ) => {\n                            console.log( 'Focus.', editor );\n                        } }\n                    />\n                  </Form.Group>\n                  </Col>\n                  </Form.Row>\n                <Button type=\"submit\">{Object.keys(props.cd).length > 0 ?\"Update CD\" :\"Create CD\"}</Button>\n              </Form> \n            </section>\n          </Col>\n        </Row> \n      </Container>\n    </>\n  );\n};\nfunction mapStateToProps(state) {\n    \n  return {\n    allPresentations:state.AllPresentationsReducer,\n    categories:state.musicReducer.categories,\n    cd:state.cdReducer,\n    allCds:state.cdsReducer,\n    lastCdId:_.orderBy(state.cdsReducer,\"id\",\"desc\").map((cd,i)=>{\n\n      return i === 0 ? cd:\"\"\n    })\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    actions: bindActionCreators({mainAction}, dispatch)\n  };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(NewCd);\n"]},"metadata":{},"sourceType":"module"}