{"ast":null,"code":"import _objectSpread from\"/Applications/MAMP/htdocs/websites/johan-de-meij/johan-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{ACTIONS}from'redux/actions/types.js';import{mainAction}from\"redux/actions/index.actions\";import{db,storage}from\"../../firebase\";var initialState={};export default function presentationMusicReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case ACTIONS.CREATE_PUBLICATION_MUSIC:{var stateCopy=action.payload;var file={id:action.payload.id,musicName:action.payload.file.name,pres_id:action.payload.pres_id};console.log(file);db.collection(\"presentationmusic\").doc().set(file).then(function(){action.asyncDispatch(mainAction(ACTIONS.CREATE_PUBLICATION_MUSIC_SUCCESS,action.payload));});return state;}case ACTIONS.CREATE_PUBLICATION_MUSIC_SUCCESS:{var postImageRef=storage.ref('music/'+action.payload.file.name).put(action.payload.file);postImageRef.on('state_changed',function(snapshot){//progress function\n},function(error){//error\nconsole.log(error);},function(){//complete\nstorage.ref('/music').child(action.payload.file.name).getDownloadURL().then(function(url){console.log(url);action.asyncDispatch(mainAction(ACTIONS.LOAD_PUBLICATION_MUSIC,action.payload.pres_id));});});}case ACTIONS.CREATE_PUBLICATION_MUSIC_FAIL:{return state;}case ACTIONS.DELETE_PUBLICATION_MUSIC:{db.collection(\"presentationmusic\").where('id','==',action.payload.ID).get().then(function(querySnapshot){querySnapshot.forEach(function(doc){console.log(doc.ref.id,doc.ref.parent,doc.ref.path);doc.ref.delete();});action.asyncDispatch(mainAction(ACTIONS.DELETE_PUBLICATION_MUSIC_SUCCESS,action.payload));});return state;}case ACTIONS.DELETE_PUBLICATION_MUSIC_SUCCESS:{var _postImageRef=storage.ref('music/'+action.payload.name);_postImageRef.delete().then(function(){return console.log(\"file deleted\");});action.asyncDispatch(mainAction(ACTIONS.LOAD_PUBLICATION_MUSIC,action.payload.ID));//window.location.reload()\nreturn state;}case ACTIONS.DELETE_PUBLICATION_MUSIC_FAIL:{return state;}case ACTIONS.LOAD_PUBLICATION_MUSIC:{db.collection(\"presentationmusic\").where(\"pres_id\",\"==\",action.payload).get().then(function(snapshot){var data=snapshot.docs.map(function(doc){return doc.data();});console.log();action.asyncDispatch(mainAction(ACTIONS.LOAD_PUBLICATION_MUSIC_SUCCESS,data));}).catch(function(err){action.asyncDispatch(mainAction(ACTIONS.LOAD_PUBLICATION_MUSIC_FAIL,action.payload));});return state;}case ACTIONS.LOAD_PUBLICATION_MUSIC_SUCCESS:{return action.payload;}case ACTIONS.LOAD_PUBLICATION_MUSIC_FAIL:{return state;}default:return _objectSpread({},state);}}","map":{"version":3,"sources":["/Applications/MAMP/htdocs/websites/johan-de-meij/johan-app/src/redux/reducers/presentationMusic.reducer.js"],"names":["ACTIONS","mainAction","db","storage","initialState","presentationMusicReducer","state","action","type","CREATE_PUBLICATION_MUSIC","stateCopy","payload","file","id","musicName","name","pres_id","console","log","collection","doc","set","then","asyncDispatch","CREATE_PUBLICATION_MUSIC_SUCCESS","postImageRef","ref","put","on","snapshot","error","child","getDownloadURL","url","LOAD_PUBLICATION_MUSIC","CREATE_PUBLICATION_MUSIC_FAIL","DELETE_PUBLICATION_MUSIC","where","ID","get","querySnapshot","forEach","parent","path","delete","DELETE_PUBLICATION_MUSIC_SUCCESS","DELETE_PUBLICATION_MUSIC_FAIL","data","docs","map","LOAD_PUBLICATION_MUSIC_SUCCESS","catch","err","LOAD_PUBLICATION_MUSIC_FAIL"],"mappings":"gLAAA,OAASA,OAAT,KAAwB,wBAAxB,CACA,OAASC,UAAT,KAA2B,6BAA3B,CACA,OAASC,EAAT,CAAYC,OAAZ,KAA0B,gBAA1B,CACA,GAAMC,CAAAA,YAAY,CAAG,EAArB,CAGA,cAAe,SAASC,CAAAA,wBAAT,EAAiE,IAA9BC,CAAAA,KAA8B,2DAAtBF,YAAsB,IAARG,CAAAA,MAAQ,2CAC5E,OAAQA,MAAM,CAACC,IAAf,EAEC,IAAKR,CAAAA,OAAO,CAACS,wBAAb,CAAwC,CACvC,GAAIC,CAAAA,SAAS,CAAGH,MAAM,CAACI,OAAvB,CACA,GAAIC,CAAAA,IAAI,CAAG,CACTC,EAAE,CAAEN,MAAM,CAACI,OAAP,CAAeE,EADV,CAETC,SAAS,CAAEP,MAAM,CAACI,OAAP,CAAeC,IAAf,CAAoBG,IAFtB,CAGTC,OAAO,CAAET,MAAM,CAACI,OAAP,CAAeK,OAHf,CAAX,CAKAC,OAAO,CAACC,GAAR,CAAYN,IAAZ,EACAV,EAAE,CAACiB,UAAH,CAAc,mBAAd,EACKC,GADL,GAEKC,GAFL,CAEST,IAFT,EAGKU,IAHL,CAGU,UAAM,CACVf,MAAM,CAACgB,aAAP,CAAqBtB,UAAU,CAACD,OAAO,CAACwB,gCAAT,CAA0CjB,MAAM,CAACI,OAAjD,CAA/B,EACD,CALL,EAMA,MAAOL,CAAAA,KAAP,CACA,CACD,IAAKN,CAAAA,OAAO,CAACwB,gCAAb,CAAgD,CAC/C,GAAIC,CAAAA,YAAY,CAAGtB,OAAO,CAACuB,GAAR,CAAY,SAASnB,MAAM,CAACI,OAAP,CAAeC,IAAf,CAAoBG,IAAzC,EAA+CY,GAA/C,CAAmDpB,MAAM,CAACI,OAAP,CAAeC,IAAlE,CAAnB,CACAa,YAAY,CAACG,EAAb,CAAgB,eAAhB,CAAgC,SAACC,QAAD,CAAY,CAC1C;AACD,CAFD,CAEE,SAACC,KAAD,CAAS,CACT;AACAb,OAAO,CAACC,GAAR,CAAYY,KAAZ,EACD,CALD,CAKE,UAAI,CACJ;AACA3B,OAAO,CAACuB,GAAR,CAAY,QAAZ,EAAsBK,KAAtB,CAA4BxB,MAAM,CAACI,OAAP,CAAeC,IAAf,CAAoBG,IAAhD,EAAsDiB,cAAtD,GAAuEV,IAAvE,CAA4E,SAAAW,GAAG,CAAE,CAC/EhB,OAAO,CAACC,GAAR,CAAYe,GAAZ,EACA1B,MAAM,CAACgB,aAAP,CAAqBtB,UAAU,CAACD,OAAO,CAACkC,sBAAT,CAAgC3B,MAAM,CAACI,OAAP,CAAeK,OAA/C,CAA/B,EACD,CAHD,EAID,CAXD,EAaA,CACD,IAAKhB,CAAAA,OAAO,CAACmC,6BAAb,CAA6C,CAC5C,MAAO7B,CAAAA,KAAP,CACA,CACD,IAAKN,CAAAA,OAAO,CAACoC,wBAAb,CAAwC,CAEpClC,EAAE,CAACiB,UAAH,CAAc,mBAAd,EACCkB,KADD,CACO,IADP,CACY,IADZ,CACiB9B,MAAM,CAACI,OAAP,CAAe2B,EADhC,EAEEC,GAFF,GAGEjB,IAHF,CAGO,SAACkB,aAAD,CAAmB,CACxBA,aAAa,CAACC,OAAd,CAAsB,SAACrB,GAAD,CAAO,CAC1BH,OAAO,CAACC,GAAR,CAAYE,GAAG,CAACM,GAAJ,CAAQb,EAApB,CAAuBO,GAAG,CAACM,GAAJ,CAAQgB,MAA/B,CAAsCtB,GAAG,CAACM,GAAJ,CAAQiB,IAA9C,EACAvB,GAAG,CAACM,GAAJ,CAAQkB,MAAR,GACA,CAHH,EAIArC,MAAM,CAACgB,aAAP,CAAqBtB,UAAU,CAACD,OAAO,CAAC6C,gCAAT,CAA0CtC,MAAM,CAACI,OAAjD,CAA/B,EACA,CATF,EAWH,MAAOL,CAAAA,KAAP,CACA,CACD,IAAKN,CAAAA,OAAO,CAAC6C,gCAAb,CAAgD,CAC/C,GAAIpB,CAAAA,aAAY,CAAGtB,OAAO,CAACuB,GAAR,CAAY,SAASnB,MAAM,CAACI,OAAP,CAAeI,IAApC,CAAnB,CACAU,aAAY,CAACmB,MAAb,GAAsBtB,IAAtB,CAA2B,iBAAIL,CAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ,CAAJ,EAA3B,EACAX,MAAM,CAACgB,aAAP,CAAqBtB,UAAU,CAACD,OAAO,CAACkC,sBAAT,CAAgC3B,MAAM,CAACI,OAAP,CAAe2B,EAA/C,CAA/B,EACA;AACA,MAAOhC,CAAAA,KAAP,CACA,CACD,IAAKN,CAAAA,OAAO,CAAC8C,6BAAb,CAA6C,CAC5C,MAAOxC,CAAAA,KAAP,CACA,CACD,IAAKN,CAAAA,OAAO,CAACkC,sBAAb,CAAsC,CACpChC,EAAE,CAACiB,UAAH,CAAc,mBAAd,EACCkB,KADD,CACO,SADP,CACiB,IADjB,CACsB9B,MAAM,CAACI,OAD7B,EAEC4B,GAFD,GAGCjB,IAHD,CAGM,SAAAO,QAAQ,CAAE,CACd,GAAMkB,CAAAA,IAAI,CAAGlB,QAAQ,CAACmB,IAAT,CAAcC,GAAd,CAAkB,SAAA7B,GAAG,CAAI,CAAC,MAAOA,CAAAA,GAAG,CAAC2B,IAAJ,EAAP,CAAkB,CAA5C,CAAb,CACA9B,OAAO,CAACC,GAAR,GACAX,MAAM,CAACgB,aAAP,CAAqBtB,UAAU,CAACD,OAAO,CAACkD,8BAAT,CAAwCH,IAAxC,CAA/B,EACD,CAPD,EAQCI,KARD,CAQO,SAAAC,GAAG,CAAE,CACX7C,MAAM,CAACgB,aAAP,CAAqBtB,UAAU,CAACD,OAAO,CAACqD,2BAAT,CAAqC9C,MAAM,CAACI,OAA5C,CAA/B,EACA,CAVD,EAYD,MAAOL,CAAAA,KAAP,CACA,CACD,IAAKN,CAAAA,OAAO,CAACkD,8BAAb,CAA8C,CAC7C,MAAO3C,CAAAA,MAAM,CAACI,OAAd,CACA,CACD,IAAKX,CAAAA,OAAO,CAACqD,2BAAb,CAA2C,CAC1C,MAAO/C,CAAAA,KAAP,CACA,CACA,QACE,wBACKA,KADL,EApFJ,CAwFD","sourcesContent":["import { ACTIONS } from 'redux/actions/types.js'\nimport { mainAction } from \"redux/actions/index.actions\"\nimport { db,storage} from \"../../firebase\";\nconst initialState = {\n   \n};\nexport default function presentationMusicReducer (state = initialState, action) {\n    switch (action.type) {\n  \n     case ACTIONS.CREATE_PUBLICATION_MUSIC : {\n      let stateCopy = action.payload\n      let file = {\n        id: action.payload.id,\n        musicName: action.payload.file.name,\n        pres_id: action.payload.pres_id,\n      }\n      console.log(file)\n      db.collection(\"presentationmusic\")\n          .doc()\n          .set(file)\n          .then(() => {\n            action.asyncDispatch(mainAction(ACTIONS.CREATE_PUBLICATION_MUSIC_SUCCESS,action.payload))\n          })\n      return state\n     }\n     case ACTIONS.CREATE_PUBLICATION_MUSIC_SUCCESS : {\n      let postImageRef = storage.ref('music/'+action.payload.file.name).put(action.payload.file);\n      postImageRef.on('state_changed',(snapshot)=>{\n        //progress function\n      },(error)=>{\n        //error\n        console.log(error)\n      },()=>{\n        //complete\n        storage.ref('/music').child(action.payload.file.name).getDownloadURL().then(url=>{\n          console.log(url)\n          action.asyncDispatch(mainAction(ACTIONS.LOAD_PUBLICATION_MUSIC,action.payload.pres_id))\n        })\n      })\n\n     }\n     case ACTIONS.CREATE_PUBLICATION_MUSIC_FAIL : {\n      return state\n     }\n     case ACTIONS.DELETE_PUBLICATION_MUSIC : {\n       \n         db.collection(\"presentationmusic\")\n         .where('id','==',action.payload.ID)\n          .get()\n          .then((querySnapshot) => {\n           querySnapshot.forEach((doc)=>{\n              console.log(doc.ref.id,doc.ref.parent,doc.ref.path)\n              doc.ref.delete()\n             })\n           action.asyncDispatch(mainAction(ACTIONS.DELETE_PUBLICATION_MUSIC_SUCCESS,action.payload))\n          });\n      \n      return state\n     }\n     case ACTIONS.DELETE_PUBLICATION_MUSIC_SUCCESS : {\n      let postImageRef = storage.ref('music/'+action.payload.name)\n      postImageRef.delete().then(()=>console.log(\"file deleted\"));\n      action.asyncDispatch(mainAction(ACTIONS.LOAD_PUBLICATION_MUSIC,action.payload.ID))\n      //window.location.reload()\n      return state\n     }\n     case ACTIONS.DELETE_PUBLICATION_MUSIC_FAIL : {\n      return state\n     }\n     case ACTIONS.LOAD_PUBLICATION_MUSIC : {\n       db.collection(\"presentationmusic\")\n       .where(\"pres_id\",\"==\",action.payload)\n       .get()\n       .then(snapshot=>{\n         const data = snapshot.docs.map(doc => {return doc.data()})\n         console.log()\n         action.asyncDispatch(mainAction(ACTIONS.LOAD_PUBLICATION_MUSIC_SUCCESS,data))\n       })\n       .catch(err=>{\n        action.asyncDispatch(mainAction(ACTIONS.LOAD_PUBLICATION_MUSIC_FAIL,action.payload))\n       })\n\n      return state\n     }\n     case ACTIONS.LOAD_PUBLICATION_MUSIC_SUCCESS : {\n      return action.payload\n     }\n     case ACTIONS.LOAD_PUBLICATION_MUSIC_FAIL : {\n      return state\n     }\n      default: \n        return {\n          ...state\n        }\n    }\n  }"]},"metadata":{},"sourceType":"module"}